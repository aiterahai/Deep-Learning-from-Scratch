# Deep Learning from Scratch

## Perceptron

​	**퍼셉트론**은 **신경망**의 기원이 되는 알고리즘입니다. 

* **퍼셉트론이란?**

  퍼셉트론은 **다수**의 **신호**를 입력으로 받아 하나의 **신호**를 출력하는 것 입니다. 

  퍼셉트론 **신호**는 **흐름**을 만들고 정보를 앞으로 전달합니다. 

  퍼셉트론은 **1과 0** 즉 **신호가 흐른다/ 신호가 흐르지 않는다**로 **두 가지 값**을 가질 수 있습니다.

![01. 퍼셉트론 - Perceptron](https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99BDCE4D5B98A1022C)

​	위의 그림은 **입력**으로 2개의 신호를 받은 퍼셉트론의 예입니다.

​	x_1과 x_2는 **입력 신호**, y는 **출력 신호**, w_1과 w_2는 **가중치**를 뜻합니다.

​	그림의 원을 **뉴런** 혹은 **노드**라고 부릅니다.

​	입력 신호가 뉴런에 보내질 때는 각각 고유한 **가중치**가 곱해집니다. (x_1w_1, x_2w_2)

​	뉴런에서 보내온 신호의 총합이 **정해진 한계**를 넘어설 때만 1을 출력합니다.

​	그 한계를 **임계값**이라 하며 θ 기호로 나타냅니다.

​	이 것을 수식으로 나타내면 아래의 수식이 됩니다.
$$
y =
\begin{cases}
0\quad  (w_1x_1\ +\ w_2x_2 \leθ)\\
1\quad  (w_1x_1\ +\ w_2x_2 >θ)
\end{cases}
$$
​	퍼셉트론은 복수의 입력 신호 각각에 고유한 **가중치**를 부여합니다.

​	**가중치**는 각 신호가 결과에 주는 **영향력을 조절하는 요소**로 작용합니다.

​	**가중치**가 클수록 해당 신호가 그만큼 **더 중요함**을 뜻합니다.

* **논리 회로**

  * **AND 게이트**

    AND 게이트는 입력이 둘이고 출력은 하나입니다.

    아래 그림 처럼 입력 신호와 출력 신호의 대응 표를 **진리표**라고 합니다.

    이 그림은 AND 게이트의 진리표로, 두 입력이 모두 1일 때만 1을 출력하고, 그 외에는 0을 출력합니다.

    | x_1  | x_2  | y    |
    | ---- | ---- | ---- |
    | 0    | 0    | 0    |
    | 0    | 1    | 0    |
    | 1    | 0    | 0    |
    | 1    | 1    | 1    |

    이 AND 게이트를 퍼셉트론으로 표현을 할 것 입니다.

    우선 진리표대로 작동하도록 하는 **w_1, w_2, θ**의 값을 정해야 합니다.

    위의 진리표를 만족하는 **매개변수** 조합은 **무한**히 많습니다.

    (w_1, w_2, θ)가 (0.5, 0.5, 0.7) 일 때, 또 (0.5, 0.5, 0.8)이나 (1.0, 1.0, 1.0) 일때 모두 **AND 게이트의 조건을 만족합니다.**

    매개변수를 이렇게 설정하면 x_1과 x_2가 모두 1일 때만 가중 신호의 총합이 주어진 **임계 값**을 웃돌게 됩니다.

  * **NAND 게이트와 OR 게이트**

    NAND 는 Not AND를 의미합니다.

    그 동작은 AND 게이트의 출력을 **뒤집은 것**이 됩니다.

    | x_1  | x_2  | y    |
    | ---- | ---- | ---- |
    | 0    | 0    | 1    |
    | 0    | 1    | 1    |
    | 1    | 0    | 1    |
    | 1    | 1    | 0    |

    진리표로 나타내면 x_1와 x_2가 모두 1일 때만 0을 출력하고 그 이외의 경우에는 1을 출력합니다.

    NAND 게이트를 표현하려면 다음과 같은 조합이 있습니다.
    $$
    (w_1, w_2, θ) = (-0.5, -0.5, -0.7)
    $$
    AND 게이트를 구현하는 **매개변수의 부호를 모두 반전**하기만 하면 NAND의 게이트가 됩니다.
    
    OR 게이트는 입력 신호 중 하나 이상이 1이면 출력이 1이 되는 논리 회로입니다.
    
    | x_1  | x_2  | y    |
    | ---- | ---- | ---- |
    | 0    | 0    | 0    |
    | 0    | 1    | 1    |
    | 1    | 0    | 1    |
    | 1    | 1    | 1    |
    
    OR 게이트를 표현하라면 다음과 같은 조합이 있습니다.
    $$
    (w_1, w_2, θ) = (0.5, 0.5, 0.3)
    $$

  이것들 처럼 퍼셉트론으로 AND, NAND, OR 과 같은 논리 회로를 표현할 수 있습니다.

  여기서 중요한 점은 퍼셉트론의 구조는 AND, NAND, OR 게이트 모두에서 똑같다는 것 입니다.

  세 가지 게이트에서 다른 것은 매개변수의 값뿐입니다.

  즉 똑같은 구조의 퍼셉트론이 매개변수의 값만 적절히 조정하여 AND, NAND, OR로 변신 할 수 있습니다.

  

* **퍼셉트론 구현하기**

  * **AND 게이트**

    ![image-20210914210504078](Image\AND.png)

    다음은 x1과 x2를 매개변수로 받는 AND라는 함수입니다.

    매개변수 w1, w2, theta는 함수 안에서 초기화하고, 가중치를 곱한 입력의 총합이 임계값을 넘으면 1을 반환하고 그 외에는 0을

    반환합니다.

    위 그림 처럼 AND 가 잘 작동하는 것을 볼 수 있습니다.

  * **가중치와 편향**

    전에 봤던 아래의 식에서
    $$
    y =
    \begin{cases}
    0\quad  (w_1x_1\ +\ w_2x_2 \leθ)\\
    1\quad  (w_1x_1\ +\ w_2x_2 >θ)
    \end{cases}
    $$
    θ를 -b로 치환하면 퍼셉트론의 동작이 아래 식처럼 됩니다.
    $$
    y =
    \begin{cases}
    0\quad  (b\ +\ w_1x_1\ +\ w_2x_2 \le0)\\
    1\quad  (b\ +\ w_1x_1\ +\ w_2x_2 >0)
    \end{cases}
    $$
    

    두개의 식은 기호만 바꿧을 뿐, 의미는 같습니다.

    여기서 b를 **편향 Bias**이라고 하고 w_1, w_2는 그대로 가중치 입니다.

    ![image-20210914212906289](Image\AND_Bias.png)

    여기에서 -θ가 편향 b로 치환이 되었습니다.

    그리고 편향은 가중치와 기능이 다르다는 사실에 주의해야 합니다.

    가중치는 각 입력 신호가 결과에 주는 영향력(중요도)을 조절하는 매개변수이고, 편향은 뉴런이 얼마나 쉽게 활성화 하느냐를

    조정하는 매개변수입니다.

  * NAND

    ![image-20210914215034074](Image\NAND.png)

    NAND는 AND의 가중치와 편향의 부호를 바꾸어 주면 됩니다.

  * OR

    ![image-20210914215814518](Image\OR.png)

    OR 게이트는 AND 게이트의 가중치와 편향만 바꾸어주면 됩니다.

  이처럼 AND, NAND, OR의 게이트는 모두 가중치와 편향만 바꾸어주면 다른 게이트를 만들어 줄 수 있습니다.

* **퍼셉트론의 한계**

  지금까지 퍼셉트론을 이용해서 AND, NAND, OR의 3가지 논리 회로를 구현 해보았습니다.

  * **XOR 게이트**

    XOR 게이트는 **베타적 논리합**이라는 논리 회로 입니다. 

    x_1과 x_2중 한쪽이 1일 때만 1을 출력합니다.

    | x_1  | x_2  | y    |
    | ---- | ---- | ---- |
    | 0    | 0    | 0    |
    | 0    | 1    | 1    |
    | 1    | 0    | 1    |
    | 1    | 1    | 0    |

    지금 까지 배운 퍼셉트론으로는 XOR 게이트를 구현할 수 없습니다.

    ![img](https://t1.daumcdn.net/cfile/tistory/992152485B98A1C705)

    위 그림과 같이 퍼셉트론은 **직선**으로 나뉜 두 영역을 만듭니다.

  * **선형과 비선형**

    만약 퍼셉트론이 직선 즉 선형이라는 제약을 없엔 **비선형**구조 라면, 아래 그림과 같이 영역을 나눌 수 있습니다.

    ![img](https://t1.daumcdn.net/cfile/tistory/991D844D5B98A1DE08)

* **다층 퍼셉트론**

  * **게이트 조합**

    ![img](https://t1.daumcdn.net/cfile/tistory/995729435B98A1FE3D)

    NAND게이트와 OR게이트와 AND게이트로 XOR게이트를 만들 수 있습니다.

  * **XOR 게이트 구현**

    ![image-20210914221845851](Image\XOR.png)

    이 것을 퍼셉트론으로 나타내면 아래 그림 처럼 됩니다.

    ![img](https://media.vlpt.us/post-images/dscwinterstudy/754c7c20-3a21-11ea-8734-d1dac55eae87/2-13XOR%EC%9D%98-%ED%8D%BC%EC%85%89%ED%8A%B8%EB%A1%A0.png)

    AND, OR이 단층 퍼셉트론 인데 반해 XOR은 2층 퍼셉트론입니다.

    따라서 이처럼 층이 여러 개인 퍼셉트론을 다층 퍼셉트론이라고 합니다.

* **정리**

  퍼셉트론은 입출력을 갖춘 알고리즘입니다. 입력을 주면 정해진 규칙에 따른 값을 출력합니다.

  퍼셉트론은 가중치와 편향을 매개변수로 설정합니다.

  퍼셉트론으로 AND, OR 게이트 등의 논리 회로를 표현할 수 있습니다.

  XOR 게이트는 단층 퍼셉트론으로는 표현할 수 없습니다.

  2층 퍼셉트론을 이용하면 XOR 게이트를 표현할 수 있습니다.

  단층 퍼셉트론은 직선형 영역만 표현할 수 있고, 다층 퍼셉트론은 비선형 영역도 표현할 수 있습니다.

  다층 퍼셉트론은 이론상 컴퓨터를 표현할 수 있습니다.